pipeline {
    agent any
    stages {
        stage('Build alpcon') {
            
           steps {
               sh "docker build -t alpcon ." 
			                
            } 
        }
        stage('Check Container') {
            steps {
		sh'''
		if !(docker ps | grep alpcon)
		then docker run -i -v $pwd:/home/script/ alpcon
		fi'''
		





            }
        }
        stage('Kiling Container') {   
         steps {
		sh '''
		if (docker ps | grep alpcon)
		then docker stop $(docker ps -l -q)
		echo "The test was failed" 
		fi'''		
            }
        }
  
    }
}
